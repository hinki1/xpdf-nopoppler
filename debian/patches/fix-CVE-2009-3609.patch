diff -urN xpdf-3.02-orig/xpdf/Stream.cc xpdf-3.02/xpdf/Stream.cc
--- xpdf-3.02-orig/xpdf/Stream.cc       2010-02-06 19:41:22.000000000 -0500
+++ xpdf-3.02/xpdf/Stream.cc    2010-02-06 19:42:38.000000000 -0500
@@ -323,6 +323,10 @@
   } else {
     imgLineSize = nVals;
   }
+  if (width > INT_MAX / nComps) {
+    // force a call to gmallocn(-1,...), which will throw an exception
+    imgLineSize = -1;
+  }
   imgLine = (Guchar *)gmallocn(imgLineSize, sizeof(Guchar));
   imgIdx = nVals;
 }
