Index: xpdf-3.02-orig/splash/Splash.cc
===================================================================
--- xpdf-3.02-orig.orig/splash/Splash.cc	2010-03-26 20:12:35.000000000 -0400
+++ xpdf-3.02-orig/splash/Splash.cc	2010-03-26 20:18:10.000000000 -0400
@@ -12,6 +12,7 @@
 
 #include <stdlib.h>
 #include <string.h>
+#include <limits.h>
 #include "gmem.h"
 #include "SplashErrorCodes.h"
 #include "SplashMath.h"
@@ -1912,7 +1913,10 @@
   xq = w % scaledWidth;
 
   // allocate pixel buffer
-  pixBuf = (SplashColorPtr)gmalloc((yp + 1) * w);
+  if (yp < 0 || yp > INT_MAX - 1) {
+    return splashErrBadArg;
+  }
+  pixBuf = (SplashColorPtr)gmallocn(yp + 1, w);
 
   // initialize the pixel pipe
   pipeInit(&pipe, 0, 0, state->fillPattern, NULL, state->fillAlpha,
@@ -2208,9 +2212,12 @@
   xq = w % scaledWidth;
 
   // allocate pixel buffers
-  colorBuf = (SplashColorPtr)gmalloc((yp + 1) * w * nComps);
+  if (yp < 0 || yp > INT_MAX - 1 || w > INT_MAX / nComps) {
+    return splashErrBadArg;
+  }
+  colorBuf = (SplashColorPtr)gmallocn(yp + 1, w * nComps);
   if (srcAlpha) {
-    alphaBuf = (Guchar *)gmalloc((yp + 1) * w);
+    alphaBuf = (Guchar *)gmallocn(yp + 1, w);
   } else {
     alphaBuf = NULL;
   }
Index: xpdf-3.02-orig/splash/SplashErrorCodes.h
===================================================================
--- xpdf-3.02-orig.orig/splash/SplashErrorCodes.h	2010-03-26 20:12:35.000000000 -0400
+++ xpdf-3.02-orig/splash/SplashErrorCodes.h	2010-03-26 20:18:10.000000000 -0400
@@ -29,4 +29,6 @@
 
 #define splashErrSingularMatrix  8	// matrix is singular
 
+#define splashErrBadArg          9     // bad argument
+
 #endif
